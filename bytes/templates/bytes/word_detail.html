{% extends 'bytes/base.html' %}

{% block title %}{{ word }} :: Parasha Bytes{% endblock %}

{% block content %}
    <h1>{{ word.english_word }} <span class="hebrew">{{ word.hebrew_word }}</span> <i>{{ word.transliterated_word }}</i></h1>

    <p>{{ word.description }}</p>

    <ul>
        {% for location in word.location.all %}
            <li>
                <div id="loc{{ forloop.counter }}" class="location">{{ location }}</div>
                <div class="row">
                    <div id="loc{{ forloop.counter }}english" class="col-sm-6">...</div>
                    <div id="loc{{ forloop.counter }}hebrew" class="col-md-6 hebrew">...</div>
                </div>
            </li>
        {% endfor %}
    </ul>
    <p><a href="{% url 'bytes:word_edit' word.pk %}"><button class="btn-default">Edit Word</button> </a></p>
{% endblock content %}

{% block end_of_body %}
    {# fetch English and Hebrew text from Sefaria #}
    <script>
        $(document).ready(function(){
            $('.location').each(function(){
                var location = $(this).text();
                location = location.replace(' ', '.');
                var baseid = $(this).attr('id');
                var url = '/bible/api/v1/texts/' + location;
                $.getJSON(url, {}, function(data){
                    $('#' + baseid + 'english').text(data.text);
                    $('#' + baseid + 'hebrew').text(data.he);
                });
            });
        });
    </script>
{% endblock end_of_body %}
